<!DOCTYPE html>
<html>

<head>
    <style>
        table {
            border-collapse: collapse;
            width: 100%;
        }

        tr,
        th,
        td {
            border: 1px solid black;
            padding: 8px;
            text-align: center;
        }

        button {
            padding: 5px 10px;
        }
    </style>
</head>

<body>
    <form id="dataForm">
        <input type="hidden" id="id" />
        <input type="text" id="name" placeholder="Name" />
        <input type="text" id="subject" placeholder="Subject" />
        <input type="text" id="city" placeholder="City" />
        <button type="submit">Submit</button>
        <button type="button" onclick="resetForm()">Cancel</button>
    </form>
    <table>
        <thead>
            <tr>
                <th>ID</th>
                <th>Name</th>
                <th>Subject</th>
                <th>City</th>
                <th>Action</th>
            </tr>
        </thead>
        <tbody id="tbody"></tbody>
    </table>


    <script>
        document.getElementById("dataForm").addEventListener("submit", function (e) {
            e.preventDefault();
            let id = document.getElementById("id").value;
            let name = document.getElementById("name").value;
            let subject = document.getElementById("subject").value;
            let city = document.getElementById("city").value;

            let data = JSON.parse(localStorage.getItem("data")) || [];

            if (id) {
                // Edit existing record
                let recordIndex = data.findIndex(item => item.id == id);
                data[recordIndex] = { id, name, subject, city };
                console.log(data);
                console.log(recordIndex);
                // debugger
                // if (recordIndex !== -1) {
                data[recordIndex] = { id, name, subject, city };
                // }
            } else {
                // Add new record
                let newRecord = {
                    id: data.length + 1, name, subject, city
                };
                data.push(newRecord);
            }

            localStorage.setItem("data", JSON.stringify(data));
            renderTable();
            resetForm();
        });

        function renderTable() {
            let tbody = document.getElementById("tbody");
            tbody.innerHTML = "";
            let data = JSON.parse(localStorage.getItem("data")) || [];
            data.forEach(item => {
                let row = tbody.insertRow();
                row.innerHTML = `
                    <td>${item.id}</td>
                    <td>${item.name}</td>
                    <td>${item.subject}</td>
                    <td>${item.city}</td>
                    <td>
                        <button onclick="editRecord(${item.id})">Edit</button>
                        <button onclick="deleteRecord(${item.id})">Delete</button>
                    </td>
                `;
            });
        }

        function editRecord(id) {
            let record = JSON.parse(localStorage.getItem("data")).find(item => item.id == id);
            document.getElementById("id").value = record.id;
            document.getElementById("name").value = record.name;
            document.getElementById("subject").value = record.subject;
            document.getElementById("city").value = record.city;
        }

        function deleteRecord(id) {
            let data = JSON.parse(localStorage.getItem("data")) || [];
            data = data.filter(item => item.id != id);
            localStorage.setItem("data", JSON.stringify(data));
            renderTable();
        }

        function resetForm() {
            document.getElementById("id").value = "";
            document.getElementById("name").value = "";
            document.getElementById("subject").value = "";
            document.getElementById("city").value = "";
        }

        renderTable();
    </script>
</body>

</html>